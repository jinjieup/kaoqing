var _0x3c27=['考勤服务Bot','#status_','ajax','Untitled','data','submit_check_time','log','data:text/csv;charset=utf-8,\ufeff','downloadExcel','22:30','23:00','value','removeChild','.csv','length','base64',':checked','getElementById','，详情请见附件','href','请选择查寝时间！','click','download'];var _0x4d9a=function(_0x3c2775,_0x4d9afd){_0x3c2775=_0x3c2775-0x0;var _0x38bbe6=_0x3c27[_0x3c2775];return _0x38bbe6;};var name_list=[];var name_room=[];var time_status=0x0;var student_status=[];var data=[];var mail_address='';function submit_data(){submit_check_time();}function submit_check_time(){if(document['getElementById']('time_selector')[_0x4d9a('0xb')]==_0x4d9a('0x9')||document['getElementById']('time_selector')[_0x4d9a('0xb')]==_0x4d9a('0xa')||document[_0x4d9a('0x11')]('time_selector')[_0x4d9a('0xb')]=='00:00'){time_status=0x1;notice_sys(time_status,_0x4d9a('0x5'));}else{notice_sys(time_status,_0x4d9a('0x5'));}}function submit_check_student(){for(let _0x339819=0x0;_0x339819<name_list['length'];_0x339819++){for(let _0x34007f=0x1;_0x34007f<=0x4;_0x34007f++){if(_0x34007f==0x1&&$(_0x4d9a('0x1')+_0x34007f+'_'+name_list[_0x339819])['is'](_0x4d9a('0x10'))==!![]){student_status[_0x339819]='已回';}else if(_0x34007f==0x2&&$(_0x4d9a('0x1')+_0x34007f+'_'+name_list[_0x339819])['is'](_0x4d9a('0x10'))==!![]){student_status[_0x339819]='请假';}else if(_0x34007f==0x3&&$('#status_'+_0x34007f+'_'+name_list[_0x339819])['is'](':checked')==!![]){student_status[_0x339819]='留校';}else if(_0x34007f==0x4&&$(_0x4d9a('0x1')+_0x34007f+'_'+name_list[_0x339819])['is'](_0x4d9a('0x10'))==!![]){student_status[_0x339819]='晚归';}}}makeTable();}function notice_sys(_0x1a2181,_0x21ec1a){if(_0x21ec1a=='submit_check_time'){if(_0x1a2181==0x1){submit_check_student();}else{alert(_0x4d9a('0x14'));return 0x0;}}}function makeTable(){var _0x34edf0=document[_0x4d9a('0x11')]('time_selector')[_0x4d9a('0xb')]+'男生查寝记录';for(let _0x5868c1=0x0;_0x5868c1<name_list[_0x4d9a('0xe')];_0x5868c1++){var _0x1a625e={'room':name_room[_0x5868c1],'name':name_list[_0x5868c1],'status':student_status[_0x5868c1]};data['push'](_0x1a625e);}this[_0x4d9a('0x8')](data,_0x34edf0);}function downloadExcel(_0x408ef8,_0x4eecdd){let _0x2aa982='房号,学生姓名,状态\x0a';for(let _0x2594e3=0x0;_0x2594e3<_0x408ef8['length'];_0x2594e3++){for(let _0x1d8ea1 in _0x408ef8[_0x2594e3]){_0x2aa982+=_0x408ef8[_0x2594e3][_0x1d8ea1]+'\x09'+',';}_0x2aa982+='\x0a';}let _0x1b4d8d=_0x4d9a('0x7')+encodeURIComponent(_0x2aa982);let _0x56c8f8=document['createElement']('a');_0x56c8f8[_0x4d9a('0x13')]=_0x1b4d8d;_0x56c8f8[_0x4d9a('0x16')]=(_0x4eecdd||_0x4d9a('0x3'))+_0x4d9a('0xd');document['body']['appendChild'](_0x56c8f8);_0x56c8f8[_0x4d9a('0x15')]();document['body'][_0x4d9a('0xc')](_0x56c8f8);}function upload(_0x435b20,_0x2085fd,_0x52c847){console[_0x4d9a('0x6')](_0x435b20);var _0x7eabfe=_0x52c847+_0x4d9a('0x12');$[_0x4d9a('0x2')]({'type':'POST','url':'https://hn216.api.yesapi.cn/api/App/Email/Send','data':{'app_key':'DF2FFBE15C848C37ED338972710EA003','return_data':0x0,'address':mail_address,'title':_0x52c847,'content':_0x7eabfe,'attachments':[{'name':_0x2085fd,'data':_0x435b20,'encoding':_0x4d9a('0xf')}],'email_sender':_0x4d9a('0x0')},'dataType':'json','success':function(_0x130d97){if(_0x130d97[_0x4d9a('0x4')]['err_code']==0x0){console['log']('Success!');}else{alert(_0x130d97['data']['err_msg']);}}});}function utftobase(_0xc74930){return window['btoa'](unescape(encodeURIComponent(_0xc74930)));}
