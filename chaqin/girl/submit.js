var _0x4431=['data','POST','body',':checked','22:30','00:00','value','submit_check_time','，详情请见附件','click','download','getElementById','女生查寝记录','ajax','房号,学生姓名,状态\x0a','json','downloadExcel','#status_','请选择查寝时间！','err_code','log','https://hn216.api.yesapi.cn/api/App/Email/Send','time_selector','href'];var _0x4dc8=function(_0x4431bf,_0x4dc875){_0x4431bf=_0x4431bf-0x0;var _0xcf5df5=_0x4431[_0x4431bf];return _0xcf5df5;};var name_list=[];var name_room=[];var time_status=0x0;var student_status=[];var data=[];var mail_address='';function submit_data(){submit_check_time();}function submit_check_time(){if(document[_0x4dc8('0xb')](_0x4dc8('0x16'))[_0x4dc8('0x6')]==_0x4dc8('0x4')||document[_0x4dc8('0xb')](_0x4dc8('0x16'))['value']=='23:00'||document[_0x4dc8('0xb')](_0x4dc8('0x16'))['value']==_0x4dc8('0x5')){time_status=0x1;notice_sys(time_status,_0x4dc8('0x7'));}else{notice_sys(time_status,'submit_check_time');}}function submit_check_student(){for(let _0xb0f884=0x0;_0xb0f884<name_list['length'];_0xb0f884++){for(let _0x4fad55=0x1;_0x4fad55<=0x4;_0x4fad55++){if(_0x4fad55==0x1&&$('#status_'+_0x4fad55+'_'+name_list[_0xb0f884])['is'](':checked')==!![]){student_status[_0xb0f884]='已回';}else if(_0x4fad55==0x2&&$(_0x4dc8('0x11')+_0x4fad55+'_'+name_list[_0xb0f884])['is'](_0x4dc8('0x3'))==!![]){student_status[_0xb0f884]='请假';}else if(_0x4fad55==0x3&&$(_0x4dc8('0x11')+_0x4fad55+'_'+name_list[_0xb0f884])['is'](_0x4dc8('0x3'))==!![]){student_status[_0xb0f884]='留校';}else if(_0x4fad55==0x4&&$('#status_'+_0x4fad55+'_'+name_list[_0xb0f884])['is'](':checked')==!![]){student_status[_0xb0f884]='晚归';}}}makeTable();}function notice_sys(_0x2fac8a,_0x2b5861){if(_0x2b5861==_0x4dc8('0x7')){if(_0x2fac8a==0x1){submit_check_student();}else{alert(_0x4dc8('0x12'));return 0x0;}}}function makeTable(){var _0x209b6f=document['getElementById']('time_selector')[_0x4dc8('0x6')]+_0x4dc8('0xc');for(let _0x5d673b=0x0;_0x5d673b<name_list['length'];_0x5d673b++){var _0x132d30={'room':name_room[_0x5d673b],'name':name_list[_0x5d673b],'status':student_status[_0x5d673b]};data['push'](_0x132d30);}this[_0x4dc8('0x10')](data,_0x209b6f);}function downloadExcel(_0x5bd5ff,_0x3fa7f9){let _0xed5c77=_0x4dc8('0xe');for(let _0x27142c=0x0;_0x27142c<_0x5bd5ff['length'];_0x27142c++){for(let _0x4dff12 in _0x5bd5ff[_0x27142c]){_0xed5c77+=_0x5bd5ff[_0x27142c][_0x4dff12]+'\x09'+',';}_0xed5c77+='\x0a';}let _0x287dbd='data:text/csv;charset=utf-8,\ufeff'+encodeURIComponent(_0xed5c77);let _0x589250=document['createElement']('a');_0x589250[_0x4dc8('0x17')]=_0x287dbd;_0x589250[_0x4dc8('0xa')]=(_0x3fa7f9||'Untitled')+'.csv';document['body']['appendChild'](_0x589250);_0x589250[_0x4dc8('0x9')]();document[_0x4dc8('0x2')]['removeChild'](_0x589250);}function upload(_0x31c955,_0xf939eb,_0x4dccd7){console['log'](_0x31c955);var _0x388765=_0x4dccd7+_0x4dc8('0x8');$[_0x4dc8('0xd')]({'type':_0x4dc8('0x1'),'url':_0x4dc8('0x15'),'data':{'app_key':'DF2FFBE15C848C37ED338972710EA003','return_data':0x0,'address':mail_address,'title':_0x4dccd7,'content':_0x388765,'attachments':[{'name':_0xf939eb,'data':_0x31c955,'encoding':'base64'}],'email_sender':'考勤服务Bot'},'dataType':_0x4dc8('0xf'),'success':function(_0x258de8){if(_0x258de8[_0x4dc8('0x0')][_0x4dc8('0x13')]==0x0){console[_0x4dc8('0x14')]('Success!');}else{alert(_0x258de8[_0x4dc8('0x0')]['err_msg']);}}});}function utftobase(_0x147777){return window['btoa'](unescape(encodeURIComponent(_0x147777)));}