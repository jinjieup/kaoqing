var _0x3835=['#status_4_','Untitled','getElementById','23:00','value','#status_1_','href','22:30','.csv','00:00','submit_check_time','#status_2_','time_selector','data:text/csv;charset=utf-8,\ufeff','#status_','btoa','removeChild','房号,学生姓名,状态\x0a',':checked','请选择查寝时间！','length'];var _0x414e=function(_0x38356f,_0x414e5b){_0x38356f=_0x38356f-0x0;var _0x5839d7=_0x3835[_0x38356f];return _0x5839d7;};var name_list=[];var name_room=[];var time_status=0x0;var student_status=[];var data=[];var mail_address='';function submit_data(){submit_check_time();}function submit_check_time(){if(document['getElementById']('time_selector')['value']==_0x414e('0x7')||document[_0x414e('0x2')]('time_selector')[_0x414e('0x4')]==_0x414e('0x3')||document[_0x414e('0x2')]('time_selector')[_0x414e('0x4')]==_0x414e('0x9')){time_status=0x1;notice_sys(time_status,'submit_check_time');}else{notice_sys(time_status,_0x414e('0xa'));}}function submit_check_student(){for(let _0x7950c7=0x0;_0x7950c7<name_list['length'];_0x7950c7++){for(let _0x22b4cb=0x1;_0x22b4cb<=0x4;_0x22b4cb++){if(_0x22b4cb==0x1&&$('#status_'+_0x22b4cb+'_'+name_list[_0x7950c7])['is'](':checked')==!![]){student_status[_0x7950c7]='已回';}else if(_0x22b4cb==0x2&&$('#status_'+_0x22b4cb+'_'+name_list[_0x7950c7])['is'](_0x414e('0x12'))==!![]){student_status[_0x7950c7]='请假';}else if(_0x22b4cb==0x3&&$(_0x414e('0xe')+_0x22b4cb+'_'+name_list[_0x7950c7])['is'](':checked')==!![]){student_status[_0x7950c7]='留校';}else if(_0x22b4cb==0x4&&$(_0x414e('0xe')+_0x22b4cb+'_'+name_list[_0x7950c7])['is'](_0x414e('0x12'))==!![]){student_status[_0x7950c7]='晚归';}else if($(_0x414e('0x5')+name_list[_0x7950c7])['is'](':checked')!=!![]&&$(_0x414e('0xb')+name_list[_0x7950c7])['is'](':checked')!=!![]&&$('#status_3_'+name_list[_0x7950c7])['is'](':checked')!=!![]&&$(_0x414e('0x0')+name_list[_0x7950c7])['is'](':checked')!=!![]){student_status[_0x7950c7]='未知';}}}makeTable();}function notice_sys(_0x1326b1,_0x3701ce){if(_0x3701ce=='submit_check_time'){if(_0x1326b1==0x1){submit_check_student();}else{alert(_0x414e('0x13'));return 0x0;}}}function makeTable(){var _0xda7550=document['getElementById'](_0x414e('0xc'))['value']+'男生查寝记录';for(let _0x1a6c84=0x0;_0x1a6c84<name_list['length'];_0x1a6c84++){var _0x546242={'room':name_room[_0x1a6c84],'name':name_list[_0x1a6c84],'status':student_status[_0x1a6c84]};data['push'](_0x546242);}this['downloadExcel'](data,_0xda7550);}function downloadExcel(_0x3cdac2,_0x5422a4){let _0x242166=_0x414e('0x11');for(let _0x3ebfc1=0x0;_0x3ebfc1<_0x3cdac2[_0x414e('0x14')];_0x3ebfc1++){for(let _0x50cd2a in _0x3cdac2[_0x3ebfc1]){_0x242166+=_0x3cdac2[_0x3ebfc1][_0x50cd2a]+'\x09'+',';}_0x242166+='\x0a';}let _0x13f4a2=_0x414e('0xd')+encodeURIComponent(_0x242166);let _0x3502be=document['createElement']('a');_0x3502be[_0x414e('0x6')]=_0x13f4a2;_0x3502be['download']=(_0x5422a4||_0x414e('0x1'))+_0x414e('0x8');document['body']['appendChild'](_0x3502be);_0x3502be['click']();document['body'][_0x414e('0x10')](_0x3502be);}function utftobase(_0x26cdf0){return window[_0x414e('0xf')](unescape(encodeURIComponent(_0x26cdf0)));}